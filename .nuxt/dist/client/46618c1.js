(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{324:function(t,e,n){var content=n(331);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(101).default)("8ba7c276",content,!0,{sourceMap:!1})},326:function(t,e,n){"use strict";n.r(e);var o=n(28),r=(n(67),n(38),n(124),n(125),n(1),n(22),{name:"Counter",props:["timestamp","autoclaim","item","claiminfo"],data:function(){return{msg:"Ready to claim",wait:!1,loaded:!1,readyToClaim:!1,last:void 0,queued:!1,displayHours:0,displayMinutes:0,displaySeconds:0,manual:!1}},computed:{ISreadyToClaim:function(){return this.readyToClaim},_seconds:function(){return 1e3},_minutes:function(){return 60*this._seconds},_hours:function(){return 60*this._minutes},remainingTime:function(){return this.loaded?this.displayHours+":"+this.displayMinutes+":"+this.displaySeconds:"Getting remaining time..."}},watch:{timestamp:function(){this.loaded=!1,this.showRemaining()},autoclaim:function(){this.autoclaim&&(this.loaded=!1,this.showRemaining())}},mounted:function(){var t=this;this.showRemaining(),this.$on("".concat(this.item.asset_id,".claiming"),(function(){t.last=Date.now(),console.log("received claiming!"),t.msg="Claiming..."})),this.$on("test",(function(t){console.log("counter receive test",t)})),this.$on("".concat(this.item.asset_id,".success"),(function(){t.last=Date.now(),console.log("received success!"),t.msg="Ready to claim",t.readyToClaim=!1,t.queued=!1,setTimeout((function(){t.last=void 0}),1e4),t.showRemaining()})),this.$on("".concat(this.item.asset_id,".retry"),(function(e){console.log("received retry!"),t.msg="Retry to claim/repair... (".concat(e,")")}))},methods:{checkManual:function(){var t=this.timestamp,e=new Date,n=new Date(t);return parseInt((n.getTime()-e.getTime())/1e3/this.item.charged_time+1).toFixed(0)>0},manualClaim:function(){var t=this;this.checkManual()&&(this.manual=!0,this.handleClaim(),setTimeout((function(){t.manual=!1}),5e3))},showRemaining:function(){var t=this,e=setInterval((function(){var n=new Date,o=t.timestamp,r=new Date(o).getTime()-n.getTime();if(r<=0)return clearInterval(e),null==t.last&&(t.readyToClaim=!0),t.loaded=!0,!0===t.$store.state.user.autoclaim[t.claiminfo.type][t.item.asset_id]&&t.handleClaim(),null;t.readyToClaim=!1;var c=Math.floor(r/t._hours),l=Math.floor(r%t._hours/t._minutes),d=Math.floor(r%t._minutes/t._seconds);t.displayHours=c<10?"0"+c:c,t.displayMinutes=l<10?"0"+l:l,t.displaySeconds=d<10?"0"+d:d,t.loaded=!0}),1e3)},handleClaim:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var data,n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t.$store.state.user.actions.find((function(e){return e.id===t.item.id}))){e.next=2;break}return e.abrupt("return");case 2:if(!t.queue){t.queued=!0;try{data="pool"==t.claiminfo.type?{_user:t.$store.state.user.name}:{asset_ids:[t.item.asset_id]},n={actions:[{account:"pool"==t.claiminfo.type?"dovsmartrepo":"dovutilstake",name:t.claiminfo.action,authorization:[{actor:t.$store.state.user.name,permission:"active"}],data:data}]},o={blocksBehind:3,expireSeconds:30},r={id:t.item.asset_id,action:n,block:o},null==t.last&&(t.readyToClaim=!0,console.log("add to queue"),t.$store.commit("user/addAction",r),t.msg="Claim in queue...")}catch(t){console.log(t)}}case 3:case"end":return e.stop()}}),e)})))()}}}),c=(n(330),n(66)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.readyToClaim?n("button",{staticClass:"EnBtn",on:{click:t.handleClaim}},[t._v(t._s(t.msg))]):n("button",{staticClass:"DisBtn",attrs:{disabled:!t.checkManual()},on:{click:t.manualClaim}},[t._v("\n    "+t._s(t.remainingTime)+"\n  ")]),t._v(" "),t.wait?n("b-spinner",{staticClass:"spinner-login",attrs:{label:"Spinning"}}):t._e()],1)}),[],!1,null,"2a2c9f54",null);e.default=component.exports},330:function(t,e,n){"use strict";n(324)},331:function(t,e,n){var o=n(100)(!1);o.push([t.i,"button[data-v-2a2c9f54]{border-radius:5px;border:none;font-weight:700;box-shadow:1px 1px 0 1px rgba(0,0,0,.2)}.DisBtn[data-v-2a2c9f54]{background:#d38c09;color:#0f0c05}.DisBtn[data-v-2a2c9f54],.EnBtn[data-v-2a2c9f54]{font-size:small}.EnBtn[data-v-2a2c9f54]{background:#28a745;color:#0f1b0e}",""]),t.exports=o}}]);